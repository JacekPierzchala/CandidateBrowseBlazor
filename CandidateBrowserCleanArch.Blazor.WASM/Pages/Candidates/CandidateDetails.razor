@page "/candidate/{id:int}"
@inject IAuthenticationService AuthenticationService
@inject ICandidatesService CandidatesService
@inject HttpInterceptorService HttpInterceptorService
@implements IDisposable
@attribute [Authorize(Policy = PermissionStatics.CandidateRead)]

@if (Candidate != null)
{
    <RadzenCard class="my-4" style="min-width:fit-content">
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Wrap="FlexWrap.Wrap">

           <RadzenCard class="rz-shadow-5 rz-my-6" >
               <CandidateDetailsMainInfo Candidate="@Candidate"/>
            </RadzenCard>
            <RadzenCard class="rz-shadow-5 rz-my-3 rz-mx-auto">
                <CandidateDetailsCompanyInfo Companies="Candidate.Companies" />
            </RadzenCard>
            <RadzenCard class="rz-shadow-5 rz-my-3 rz-mx-auto">
                <CandidateDetailsProjectInfo Projects="Candidate.Projects" />
            </RadzenCard>
        </RadzenStack>
    </RadzenCard>

}
else
{
    <LoadingElement Message="Loading candidate details..." />
}


@code {
    [Parameter]
    public int Id { get; set; }
    CandidateDetailsDto Candidate;
    bool loadDataResult;
    protected async override Task OnInitializedAsync()
    {
        HttpInterceptorService.RegisterEvent();

        var request = await CandidatesService.GetCandidateDetailsAsync(Id);
        loadDataResult = request.Success;
        Candidate = request.Data;
    }


    public void Dispose()
    {
        HttpInterceptorService.DisposeEvent();
    }
}
